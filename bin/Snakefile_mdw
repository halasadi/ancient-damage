import glob, os

ANCIENT_SAMPLES = [os.path.splitext(x)[0] for x in list(map(os.path.basename, glob.glob("/project/jnovembre/share/ancient_dna_data/bam/*.bam")))]

workdir: '/project/mstephens/ancient-damage/'
rule all:
    input:
        expand('csv/{sample}.q30.csv', sample = ANCIENT_SAMPLES)
    
rule call_damage:
    input:
        bam = '/project/jnovembre/share/ancient_dna_data/bam/{sample}.bam',
        bai = '/project/jnovembre/share/ancient_dna_data/bam/{sample}.bam.bai'
    output:
        'csv/{sample}.q30.csv'
    shell:
        'python /home/halasadi/ancient-damage/bin/generate_summary_data.py -f {input.bam} -o {output}'

